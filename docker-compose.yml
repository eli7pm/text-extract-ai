version: '3.8'

services:
  document-engine:
    image: pspdfkit/document-engine:latest
    container_name: nutrient-document-engine
    ports:
      - "5000:5000"
    environment:
      # Database configuration (required)
      PGUSER: postgres
      PGPASSWORD: password
      PGDATABASE: document-engine
      PGHOST: db
      PGPORT: 5432

      # JWT Configuration
      JWT_ALGORITHM: RS256
      JWT_PUBLIC_KEY: |
        -----BEGIN PUBLIC KEY-----
        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwA7XlDCL6yWTSqgZb5+M
        GRgIayNtRZqGn2E2FVF3uT8eKAoOV0MrLvig+d99UJq2lgkoM+S6XhNxkZAo63ZA
        Kq77V+SzBMiDAl7HOXfSUYjtZqwl9trGK4pg/iGVo2X4KVZFdNFZEJFDDW3PKyWb
        HoF1EyXakJVeutD+vLp8mfBPlU/E1ThbdsI+sCALGMmMHkseivvTltkGfNRPTp4P
        rRPp048g+7dSzSuc9HlrmklPvT106MQnQXBKazy9LudDPK4QIKoEio3AzDPkWaL3
        fyhStKHxb2Yxs9VvY4uEg5LjTOjG+bg7pKM98yduQKH2yu6SwpbCT6HJr8YrH5R6
        RQIDAQAB
        -----END PUBLIC KEY-----
      # Activation key (get from https://my.nutrient.io/)
      API_AUTH_TOKEN: secret

      # Enable dashboard for debugging
      DASHBOARD_ENABLED: "true"
      DASHBOARD_USERNAME: dashboard
      DASHBOARD_PASSWORD: secret
    depends_on:
      - db
    volumes:
      # Optional: persist assets
      - document-engine-assets:/assets

  db:
    image: postgres:15-alpine
    container_name: nutrient-postgres
    ports:
      - "5432:5432"
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
      POSTGRES_DB: document-engine
    volumes:
      - postgres-data:/var/lib/postgresql/data

volumes:
  document-engine-assets:
  postgres-data:
